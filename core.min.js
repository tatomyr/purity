const isEmpty=t=>!t||!Object.keys(t).length,clearFalsy=t=>null==t||!1===t?"":t,joinIfArray=t=>Array.isArray(t)?t.join(""):t,PURITY_KEYWORD="purity",DATA_PURITY_FLAG="data-purity_flag";export const createStore=(t=(()=>({})),e=(()=>{}))=>{const r=t(void 0,{type:"INIT"}),o=t=>{const e=(new DOMParser).parseFromString(t,"text/html"),r=new Map;for(const t of e.querySelectorAll("[id]")){const e=t.cloneNode(!0);for(const t of e.querySelectorAll("[id]"))t.outerHTML=`\x3c!-- ${t.tagName}#${t.id} --\x3e`;for(const t of e.querySelectorAll("[data-purity_flag]"))for(let e in t.dataset)e.startsWith("purity")&&t.removeAttribute("data-"+e);r.set(t.id,{node:t,shallow:e})}return r};let n,s;function a(t,e){for(const{name:e}of t.attributes)"id"!==e&&t.removeAttribute(e);for(const{name:r,value:o}of e.node.attributes)"id"!==r&&t.setAttribute(r,o)}function l(){const t=o(n());for(const[e,r]of s){const o=t.get(e);if(o&&r.shallow.outerHTML!==o.shallow.outerHTML){const t=document.getElementById(e);a(t,o),r.shallow.innerHTML!==o.shallow.innerHTML&&(t.innerHTML=o.node.innerHTML,console.log("â†» #"+e))}}s=t}function c(o){const n=t(r,o);var s;(s=n)&&Object.keys(s).length&&(Object.assign(r,n),l()),e(o,c,r)}return{mount:function(t){n=t,s=o(n());const a=s.keys().next().value;document.getElementById(a).replaceWith(s.get(a).node),e({type:"INIT"},c,r)},dispatch:c,connect:t=>e=>t(Object.assign({},r,e)),rerender:l,getState:()=>r}};const ARGS_RE=/__\[(\d+)\]__/gm,BOUND_EVENTS_RE=/::(\w+)\s*=\s*__\[(\d+)\]__/gm;let purity_key=0;export const render=([t,...e],...r)=>{const o=e.reduce((t,e,r)=>`${t}__[${r}]__${e}`,t).replace(BOUND_EVENTS_RE,(t,e,o)=>{let n=`data-purity_${e}_${`${purity_key}_${o}`}`;return setTimeout(()=>{let t=document.querySelector(`[${n}]`);t&&(t["on"+e]=r[o],t.removeAttribute(n))}),n+" data-purity_flag"}).replace(ARGS_RE,(t,e)=>{return joinIfArray(null==(o=r[+e])||!1===o?"":o);var o}).trim().replace(/\n\s*</g,"<").replace(/>\n\s*/g,">");return purity_key++,setTimeout(()=>{purity_key=0}),o};
