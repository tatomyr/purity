const PURITY_KEYWORD="purity",DATA_PURITY_FLAG="data-purity_flag";export const init=e=>{const t=e;let o,r;function n(e,t){for(const{name:t}of e.attributes)e.removeAttribute(t);for(const{name:o,value:r}of t.node.attributes)e.setAttribute(o,r)}function s(){const e=o();console.warn("ðŸŒ€");for(const[t,o]of r){const r=e.get(t);if(r&&o.shallow.outerHTML!==r.shallow.outerHTML){const e=document.getElementById(t);if(!e)throw new Error(`There is no element in the DOM with id "${t}".`);n(e,r),o.shallow.innerHTML!==r.shallow.innerHTML?(e.innerHTML=r.node.innerHTML,console.warn(`\tâ†» #${t}`)):console.warn(`\tÂ± #${t}`)}}r=e}return{mount:function(e){o=()=>(e=>{const t=(new DOMParser).parseFromString(e,"text/html"),o=new Map;for(const e of t.querySelectorAll("[id]")){const t=e.cloneNode(!0);for(const e of t.querySelectorAll("[id]"))e.outerHTML=`\x3c!-- ${e.tagName}#${e.id} --\x3e`;for(const e of t.querySelectorAll(`[${DATA_PURITY_FLAG}]`))for(const t in e.dataset)t.startsWith("purity")&&e.removeAttribute(`data-${t}`);o.set(e.id,{node:e,shallow:t})}return o})(e()),r=o();const t=r.keys().next().value,n=document.getElementById(t),s=r.get(t)?.node;if(!n||!s)throw new Error(`Root DOM element's id does not correspond to the defined application root id "${t}".`);n.replaceWith(s)},rerender:s,getState:()=>t,setState(e){Object.assign(t,e(t)),s()}}};const ARGS_RE=/__\[(\d+)\]__/gm,BOUND_EVENTS_RE=/::(\w+)\s*=\s*__\[(\d+)\]__/gm;export const isTruthy=e=>null!=e&&!1!==e;const clearFalsy=e=>isTruthy(e)?e:"",joinIfArray=e=>Array.isArray(e)?e.join(""):e,applyPurityKey=(()=>{let e,t=0;return()=>(e&&clearTimeout(e),e=setTimeout(()=>{t=0}),t++)})();export const render=([e,...t],...o)=>t.reduce((e,t,o)=>`${e}__[${o}]__${t}`,e).replace(BOUND_EVENTS_RE,(e,t,r)=>{const n=`data-purity_${t}_${applyPurityKey()}`;return setTimeout(()=>{const e=document.querySelector(`[${n}]`),s=o[r];e&&"function"==typeof s&&(e[`on${t}`]=s,e.removeAttribute(n))}),`${n} ${DATA_PURITY_FLAG}`}).replace(ARGS_RE,(e,t)=>joinIfArray(clearFalsy(o[+t]))).trim().replace(/\n\s*</g,"<").replace(/>\n\s*/g,">");
